# Example unified Mouc configuration file
# This file combines resources and Jira integration settings

# Global DNS periods (apply to all resources)
global_dns_periods:
  - start: 2025-12-24  # Company holiday break
    end: 2025-12-31
  - start: 2025-07-04  # Independence Day
    end: 2025-07-04

# Resource definitions
resources:
  - name: alice
    # Optional: Map Jira username to this resource
    # Takes priority over automatic domain stripping
    jira_username: alice@example.com
    dns_periods:
      - start: 2025-12-15
        end: 2026-01-01

  - name: bob
    jira_username: bob.smith@example.com
    dns_periods:
      - start: 2025-07-01
        end: 2025-07-15

  - name: charlie
    # No jira_username specified - will use automatic mapping
    dns_periods: []

# Resource groups (aliases)
groups:
  backend_team:
    - alice
    - bob
  frontend_team:
    - charlie

# Default resource for unassigned tasks
default_resource: "*"

# Markdown output settings (optional)
markdown:
  # Table of contents control
  # Valid values: "timeline" and "entity_types"
  toc_sections: [timeline, entity_types]
  # Document organization
  organization:
    primary: "by_type"                              # or "by_timeframe", "alpha_by_id", "yaml_order"
    secondary: null                                  # or "by_timeframe", "by_type"
    entity_type_order: [capability, user_story, outcome]

# Jira integration settings
jira:
  base_url: "https://example.atlassian.net"

  # Automatically strip email domain from Jira usernames
  # e.g., "charlie@example.com" -> "charlie" (if resource "charlie" exists)
  # Default: false (opt-in)
  strip_email_domain: false

# Field mappings between Jira and Mouc
field_mappings:
  # Start date mapping
  start_date:
    # Option 1: Use explicit Jira field name (takes precedence)
    explicit_field: "Start date"
    # Option 2: Derive from status transition (fallback)
    transition_to_status: "In Progress"
    # How to resolve conflicts
    conflict_resolution: "jira_wins"  # or "mouc_wins" or "ask"

  # End date mapping
  end_date:
    explicit_field: "Due Date"
    transition_to_status: "Done"

  # Effort/story points mapping
  effort:
    # Option 1: Use Story Points custom field
    jira_field: "Story Points"
    unit: "sp"
    conversion: "1sp=1d"  # 1 story point = 1 day

    # Option 2: Use Jira's built-in time tracking (Original Estimate)
    # This returns values like "3w", "5d", etc. - no conversion needed
    # jira_field: "Original Estimate"

    # Option 3: Use Remaining Estimate
    # jira_field: "Remaining Estimate"

  # Status mapping
  status:
    status_map:
      "Done": "done"
      "In Progress": "in_progress"
      "To Do": "todo"

  # Resource mapping
  resources:
    # Value to use for unassigned tickets
    unassigned_value: "*"
    # NOTE: Use jira_username in resource definitions instead of assignee_map

# Global defaults
defaults:
  conflict_resolution: "ask"
  skip_missing_fields: true
  timezone: "UTC"
